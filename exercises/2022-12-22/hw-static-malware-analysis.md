# Static malware analysis exercise

Date: `Thu 22 Dec 2022 06:25 IST`

# Questions


1.  What is the function `SetWindowsHookEx` is doing? To which DLL is belongs?
2.  What is the function `RegisterHotKey` is doing? To which DLL is belongs?
3.  What the DLL `Shell32.dll` is responsible for?
4.  Which registry keys can be used to maintain persistency?
5.  It’s the middle of the night, suddenly you are receiving an email. Since 
    you are not familiar with the sender, and as a security expert, before opening 
    any attachment, you first want to check it. The email message contains .doc 
    file (SHA1 - `776c469861c3ac30aa63d9434449498456864653 `).

    Use web resources to explain:

    1.  What is the delivery method the attacker is using?  
    2.  How is this file related to the domain - `gamestoredownload.download`?
    3.  The final payload of this malware is the file: `gamepa.exe`, which tries 
        to steal different types of credentials from the infected host.
        
        i. How would you classify this malware?
        ii. Based on hybrid-analysis report, what is the C2 server of this malware?


# 1. SetWindowsHookEx

> `SetWindowsHookEx` can be used to inject a DLL into another process. [[1]]

> `winuser.h` header file, which is part of the Windows driver development kit... [[2]]

> we can use the `SetWindowsHookEx` function to inject the DLL into the 
process’s address space and execute arbitrary code inside the process’s address
 space. [[2]]


[1]: https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowshookexa#remarks
[2]: https://resources.infosecinstitute.com/topic/using-setwindowshookex-for-dll-injection-on-windows

# 2. RegisterHotKey

# 3. `Shell32.dll`

# 4. Which registry keys can be used to maintain persistency?


[3]: https://www.virustotal.com/gui/file/05d54ff3fb7e4d8cfaafcbba08ec217c1bff60216e23c3fdca0bbc80c627c9bc

# 5. [`receipt.docx` analysis](receipt.docx.md)